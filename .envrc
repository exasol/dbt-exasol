#!/bin/bash

# Automatically sets up your devbox environment whenever you cd into this
# directory via our direnv integration:

eval "$(devbox generate direnv --print-envrc)"
dotenv_if_exists

# Create wrapper script for nox to run via uv
mkdir -p .devbox/bin
cat > .devbox/bin/nox << 'EOF'
#!/bin/bash
exec uv run nox "$@"
EOF
chmod +x .devbox/bin/nox

# Add .devbox/bin to PATH (must be after devbox generate)
PATH_add .devbox/bin

# Configure Docker to connect via SSH
if [ -n "$DOCKER_SSH_HOST" ]; then
  export DOCKER_HOST="ssh://${DOCKER_SSH_HOST}"
  export DOCKER_BUILDKIT=1
  export DOCKER_API_VERSION=1.41  # Compatible with Docker 20.10.x
fi

# check out https://www.jetify.com/docs/devbox/ide_configuration/direnv/
# for more details
